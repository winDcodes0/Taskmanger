<!DOCTYPE html>
<html>
<head>
<title>Login + Task Manager</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#4e73df,#1cc88a);
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    margin:0;
    padding:20px;
}

.container {
    width:90%;
    max-width:350px;
    background:white;
    padding:25px;
    border-radius:10px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
}

h2 { 
    text-align:center; 
    margin-bottom:15px;
}

input {
    width:100%;
    padding:10px;
    margin:10px 0;
    font-size:16px;
}

button {
    width:100%;
    padding:10px;
    background:#4e73df;
    color:white;
    border:none;
    cursor:pointer;
    font-size:16px;
    border-radius:5px;
}

button:hover { 
    background:#2e59d9; 
}

.hidden { 
    display:none; 
}

ul { 
    list-style:none; 
    padding:0; 
}

li {
    background:#f2f2f2;
    margin:8px 0;
    padding:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-radius:5px;
    flex-wrap:wrap;
}

.logout-btn {
    background:red;
    margin-bottom:10px;
}

a{
    color:#4e73df;
    text-decoration:none;
    font-weight:bold;
}

a:hover{
    text-decoration:underline;
}

/* Mobile Optimization */
@media (max-width: 480px) {

    body {
        align-items:flex-start;
        padding-top:40px;
    }

    .container {
        padding:20px;
        border-radius:15px;
    }

    h2 {
        font-size:20px;
    }

    li {
        flex-direction:column;
        align-items:flex-start;
        gap:5px;
    }

    button {
        font-size:15px;
    }
}

</style>
</head>

<body>

<div class="container">

<!-- LOGIN SECTION -->
<div id="loginSection">
    <h2>Login</h2>
    <input type="text" id="loginUsername" placeholder="Username">
    <input type="password" id="loginPassword" placeholder="Password">
    <button onclick="login()">Login</button>
    <p style="text-align:center;margin-top:10px;">
        Don't have account? 
        <a href="#" onclick="showRegister()">Register</a>
    </p>
</div>

<!-- REGISTER SECTION -->
<div id="registerSection" class="hidden">
    <h2>Register</h2>
    <input type="text" id="registerUsername" placeholder="Username">
    <input type="password" id="registerPassword" placeholder="Password">
    <button onclick="register()">Register</button>
    <p style="text-align:center;margin-top:10px;">
        Already have account? 
        <a href="#" onclick="showLogin()">Login</a>
    </p>
</div>

<!-- TASK SECTION -->
<div id="taskSection" class="hidden">
    <button class="logout-btn" onclick="logout()">Logout</button>
    <h2>Task Manager</h2>
    <input type="text" id="taskInput" placeholder="Add task">
    <button onclick="addTask()">Add</button>
    <ul id="taskList"></ul>
</div>

</div>

<script>

let users = JSON.parse(localStorage.getItem("users")) || [];
let currentUser = localStorage.getItem("currentUser");

if(currentUser){
    showTasks();
}

function showRegister(){
    document.getElementById("loginSection").classList.add("hidden");
    document.getElementById("registerSection").classList.remove("hidden");
}

function showLogin(){
    document.getElementById("registerSection").classList.add("hidden");
    document.getElementById("loginSection").classList.remove("hidden");
}

function register(){
    let username = document.getElementById("registerUsername").value.trim();
    let password = document.getElementById("registerPassword").value.trim();

    if(username === "" || password === ""){
        alert("Please fill all fields");
        return;
    }

    let existingUser = users.find(u => u.username === username);

    if(existingUser){
        alert("Username already exists");
        return;
    }

    users.push({username, password});
    localStorage.setItem("users", JSON.stringify(users));

    alert("Registered Successfully!");
    showLogin();
}

function login(){
    let username = document.getElementById("loginUsername").value.trim();
    let password = document.getElementById("loginPassword").value.trim();

    if(username === "" || password === ""){
        alert("Enter username & password");
        return;
    }

    let user = users.find(u => u.username === username && u.password === password);

    if(user){
        localStorage.setItem("currentUser", username);
        showTasks();
    } else {
        alert("Invalid Credentials");
    }
}

function logout(){
    localStorage.removeItem("currentUser");
    location.reload();
}

function showTasks(){
    document.getElementById("loginSection").classList.add("hidden");
    document.getElementById("registerSection").classList.add("hidden");
    document.getElementById("taskSection").classList.remove("hidden");
    displayTasks();
}

function addTask(){
    let input = document.getElementById("taskInput");
    let text = input.value.trim();
    if(text === "") return;

    let tasks = JSON.parse(localStorage.getItem(currentUser+"_tasks")) || [];
    tasks.push(text);
    localStorage.setItem(currentUser+"_tasks", JSON.stringify(tasks));
    input.value="";
    displayTasks();
}

function displayTasks(){
    let tasks = JSON.parse(localStorage.getItem(currentUser+"_tasks")) || [];
    let list = document.getElementById("taskList");
    list.innerHTML="";

    tasks.forEach((task,index)=>{
        let li = document.createElement("li");
        li.innerHTML = `${task} 
            <button onclick="deleteTask(${index})">X</button>`;
        list.appendChild(li);
    });
}

function deleteTask(index){
    let tasks = JSON.parse(localStorage.getItem(currentUser+"_tasks")) || [];
    tasks.splice(index,1);
    localStorage.setItem(currentUser+"_tasks", JSON.stringify(tasks));
    displayTasks();
}

</script>

</body>
</html>
